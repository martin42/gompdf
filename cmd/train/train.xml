{{define "train"}}

<Document>

<Meta>
    <Author>mazzegi</Author>
    <Creator>MPDF</Creator>
    <Subject>Train Export</Subject>
</Meta>

<Default>
    <Orientation>portrait</Orientation>
    <Unit>mm</Unit>
    <Format>a4</Format>
    <PageBreaks>auto</PageBreaks>
    <PageMargins>
        <Left>30</Left>
        <Top>20</Top>
        <Right>10</Right>
        <Bottom>5</Bottom>
    </PageMargins>
</Default>

<Style>
chapter-font{
    font-family: Arial;
    font-point-size: 16;
    font-style: normal;        
}

paragraph-font{
    font-family: Arial;
    font-point-size: 12;
    font-style: normal;        
}

default-font{
    font-family: Arial;
    font-point-size: 10;
    font-style: normal;	
}

default-font-times{
    font-family: Times;
    font-point-size: 12;
    font-style: normal;	
}

default-font-small{
    font-family: Arial;
    font-point-size: 8;
    font-style: normal;	
}

general-table-label{
    font-family: Arial;
    font-point-size: 8;
    font-style: normal;
}
general-table-value{
    font-family: Arial;
    font-point-size: 10;
    font-style: normal;
    padding: 0,0,0,2;
}
vehicle-table-value{
    font-family: Arial;
    font-point-size: 10;
    font-style: normal;        
}
percent-bar {
    font-family: Arial;
    font-point-size: 6;        
    h-align: left;
    line-width: 0.2; 
    color: #888888; 
    background-color: #dddddd; 
    border: 1,1,1,1;
    offset-x: 8; 
    offset-y: 0.5; 
}
</Style>

<Header>    
<Font class="default-font"/>
<SetY y="5"/>
<Table>
    <Tr style="border: 0,0,0,0;">
        <Td style="column-width: 50; h-align: left;">voestalpine SIGNALING</Td>
        <Td style="h-align: center; column-width: 80;">{{.System}} - {{.Started}}</Td>
        <Td style="h-align: right; padding: 0,0,1,0;">{cp} / {np} </Td>
    </Tr>  
</Table>
<SetY y="20"/>
</Header> 

<Footer>    
</Footer>

<Body>

<Font class="chapter-font"/>
<Text>__General__</Text>
<Lf lines="1"/>

<Table>
    <Tr class="general-table-label">
        <Td>__Started__</Td>
        <Td>__Finished__</Td>
        <Td>__Number__</Td>
        <Td>__Operator__</Td>
    </Tr>
    <Tr class="general-table-value">
        <Td>{{.Started}}</Td>
        <Td>{{.Finished}}</Td>
        <Td>{{.Number}}</Td>
        <Td>{{.Operator}}</Td>
    </Tr>

    <Tr class="general-table-label">
        <Td>__System__</Td>
        <Td>__Track__</Td>
        <Td>__Direction__</Td>
        <Td>__Ambient Temp.__</Td>
    </Tr>
    <Tr class="general-table-value">
        <Td>{{.System}}</Td>
        <Td>{{.Track}}</Td>
        <Td>{{.Direction}}</Td>
        <Td>{{.Ambient}} °C</Td>
    </Tr>

    <Tr class="general-table-label">
        <Td>__Speed__</Td>
        <Td>__Length__</Td>
        <Td>__Axles__</Td>
        <Td>__Weight__</Td>
    </Tr>
    <Tr class="general-table-value">
        <Td>{{.Speed}}</Td>
        <Td>{{.Length}}</Td>
        <Td>{{.Axles}}</Td>
        <Td>-</Td>
    </Tr>
</Table>

<Lf lines="1"/>
<Text class="chapter-font">__Alarms__</Text>
<Text class="default-font-small">*2 alarms where found for this train-passage*</Text> 
<Lf lines="1"/>
{{range .Alarms}}
<Table>
    <Tr>
        <Td style="column-width: 60; border: 1,1,1,0;"></Td>
        <Td class="general-table-label" style="border: 1,1,1,0;">__State:__ {{.CaseState.Message}}</Td>
    </Tr>
    <Tr class="default-font-small">
        <Td style="border: 1,0,1,0;"></Td>   
        <Td style="border: 1,0,1,1;">by {{.CaseState.By}} - {{.CaseState.Date}}</Td>     
    </Tr>

    <Tr>
        <Td class="default-font-small" style="h-align: center; border: 1,0,1,0;">({{.VehicleID}})</Td>
        <Td class="general-table-label" style="border: 1,1,1,0;">__Assessment:__ {{.CaseAssessment.Message}}</Td>
    </Tr>
    <Tr class="default-font-small">
        <Td class="default-font-small" style="h-align: center; border: 1,0,1,0;">{{.Entity}}</Td> 
        <Td style="border: 1,0,1,1;">by {{.CaseAssessment.By}} - {{.CaseAssessment.Date}}</Td>       
    </Tr>

    <Tr>
        <Td class="default-font-small" style="h-align: center; border: 1,0,1,0;">{{.Description}}</Td>      
        <Td class="general-table-label" style="border: 1,1,1,0;">__Treatment:__ {{.CaseTreatment.Message}}</Td>
    </Tr>
    <Tr class="default-font-small">
        <Td class="default-font-small" style="h-align: center; border: 1,0,1,0;">{{.Value}}</Td>  
        <Td style="border: 1,0,1,1;">by {{.CaseTreatment.By}} - {{.CaseTreatment.Date}}</Td>         
    </Tr>

    <Tr>
        <Td style="border: 1,0,1,0;"></Td>  
        <Td class="general-table-label" style="border: 1,1,1,0;">__Remark:__ {{.CaseRemark.Message}}</Td>
    </Tr>
    <Tr class="default-font-small">
        <Td style="border: 1,0,1,1;"></Td>  
        <Td style="border: 1,0,1,1;">by {{.CaseRemark.By}} - {{.CaseRemark.Date}}</Td>               
    </Tr>
</Table>
{{end}}

<Lf lines="1"/>
<Text class="chapter-font">__HBD at {{.System}}__</Text>
<Lf lines="1"/>

{{range .Vehicles}}
<Table>
    <Tr style="border: 1,1,1,1;">        
        <Td class="paragraph-font" style="column-span: 5; padding: 1,1,1,1;">__No. {{.Number}} ({{.ID}})__</Td>        
    </Tr>
    <Tr class="general-table-label" style="border: 1,1,1,0; padding: 1,1,1,1;">
        <Td style="column-span: 2">__ID__</Td>
        <Td style="column-span: 2">__Type__</Td>
        <Td>__Operator__</Td>        
    </Tr>
    <Tr class="vehicle-table-value" style="border: 1,0,1,1; padding: 1,1,1,1;">
        <Td style="column-span: 2">{{.ID}}</Td>
        <Td style="column-span: 2">{{.Type}}</Td>
        <Td>{{.Operator}}</Td>        
    </Tr>
    <Tr class="default-font-small" style="border: 1,1,1,1; padding: 1,1,1,1;">
        <Td style="column-width: 12;">__Axle__</Td>
        <Td>__Bearing Left / °C__</Td>
        <Td>__Bearing Right / °C__</Td>
        <Td>__Disk / °C__</Td>
        <Td>__Brake / °C__</Td>
    </Tr>
    {{$axles := .Axles}}
    {{range $i,$e := .Axles}}
    {{if eq (number $i) (len $axles)}}
    <Tr class="default-font-small" style="border: 1,0,1,1; padding: 1,1,1,1">
    {{else if eq $i 0}}
    <Tr class="default-font-small" style="border: 1,1,1,0; padding: 1,1,1,1">
    {{else}}
    <Tr class="default-font-small" style="border: 1,0,1,0; padding: 1,1,1,1;">
    {{end}}
        <Td>{{.Number}}</Td>
        <Td>
            {{$width := scaleTemp .BearingLeft 25}}
            <Box class="default-font-small" style="width: 5;">{{.BearingLeft.Value}}</Box>            
            <Box class="percent-bar" style="width: 25; background-color: #eeeeee;"></Box>            
            <Box class="percent-bar" style="width: {{$width}}; background-color: {{tempAlarmColor .BearingLeft}};"></Box>
        </Td>
        <Td>                        
            {{$width := scaleTemp .BearingRight 25}}
            <Box class="default-font-small" style="width: 5;">{{.BearingRight.Value}}</Box>  
            <Box class="percent-bar" style="width: 25; background-color: #eeeeee;"></Box>            
            <Box class="percent-bar" style="width: {{$width}}; background-color: {{tempAlarmColor .BearingRight}};"></Box> 
        </Td>
        <Td>                    
            {{$width := scaleTemp .Disk 25}}
            <Box class="default-font-small" style="width: 5;">{{.Disk.Value}}</Box>  
            <Box class="percent-bar" style="width: 25; background-color: #eeeeee;"></Box>            
            <Box class="percent-bar" style="width: {{$width}}; background-color: {{tempAlarmColor .Disk}};"></Box>        
        </Td>
        <Td>            
            {{$width := scaleTemp .Brake 25}}
            <Box class="default-font-small" style="width: 5;">{{.Brake.Value}}</Box>  
            <Box class="percent-bar" style="width: 25; background-color: #eeeeee;"></Box>            
            <Box class="percent-bar" style="width: {{$width}}; background-color: {{tempAlarmColor .Brake}};"></Box>
        </Td>
    </Tr>
    {{end}}
</Table>
<Lf lines="1"/>
{{end}}

</Body> 

</Document>

{{end}}